"use strict";const h=require("electron"),t=require("node:path"),d=require("node:fs/promises");console.log("ELECTRON REQUIRE:",h);const{app:r,BrowserWindow:u,ipcMain:i,dialog:p}=h;r.isPackaged?process.env.DIST=t.join(t.dirname(__dirname),"dist"):process.env.DIST=t.join(__dirname,"../dist");process.env.VITE_PUBLIC=r.isPackaged?process.env.DIST:t.join(process.env.DIST,"../public");let e;const l=process.env.VITE_DEV_SERVER_URL;function f(){if(e=new u({icon:t.join(process.env.VITE_PUBLIC||"","electron-vite.svg"),webPreferences:{preload:t.join(__dirname,"preload.cjs")},width:1200,height:800,titleBarStyle:"hiddenInset",vibrancy:"under-window",visualEffectState:"active"}),e.webContents.on("did-finish-load",()=>{e==null||e.webContents.send("main-process-message",new Date().toLocaleString())}),e.webContents.openDevTools(),l)console.log("Loading DEV URL:",l),e.loadURL(l);else{const o=t.join(process.env.DIST||"","index.html");console.log("Loading production file:",o),console.log("File exists:",require("fs").existsSync(o)),console.log("DIST path:",process.env.DIST),console.log("__dirname:",__dirname),console.log("app.isPackaged:",r.isPackaged),e.loadFile(o)}}r.on("window-all-closed",()=>{process.platform!=="darwin"&&r.quit()});r.on("activate",()=>{u.getAllWindows().length===0&&f()});r.whenReady().then(()=>{f(),i.handle("select-files",async()=>e?(await p.showOpenDialog(e,{properties:["openFile","multiSelections"]})).filePaths:[]),i.handle("rename-files",async(o,a)=>{const n=[];for(const s of a)try{await d.rename(s.oldPath,s.newPath),n.push({path:s.oldPath,success:!0})}catch(c){n.push({path:s.oldPath,success:!1,error:c.message})}return n}),i.handle("copy-rename-files",async(o,a)=>{const n=[];for(const s of a)try{await d.copyFile(s.oldPath,s.newPath),n.push({path:s.oldPath,success:!0})}catch(c){n.push({path:s.oldPath,success:!1,error:c.message})}return n}),i.handle("select-directory",async()=>e?(await p.showOpenDialog(e,{properties:["openDirectory"]})).filePaths[0]:void 0)});
